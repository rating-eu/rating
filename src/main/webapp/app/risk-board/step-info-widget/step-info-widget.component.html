<!--
  ~ Copyright 2019 HERMENEUT Consortium
  ~  
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~  
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~  
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~
  -->

<ng-container *ngIf="loading">
    <div class="loader"></div>
</ng-container>
<ng-container *ngIf="!loading">
    <mat-accordion>
        <mat-expansion-panel [expanded]="true">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    <h2>
                        <a href="javascript:void(0);" class="collapse-link">Check your progress</a>
                    </h2>
                </mat-panel-title>
            </mat-expansion-panel-header>

            <div class="table-responsive">
                <table class="table">
                    <thead>
                    <tr>
                        <th style="width: 15%">Steps</th>
                        <th>Description</th>
                        <th>Status</th>
                        <th style="width: 7%" class="text-center">Action</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>Asset Clustering</td>
                        <td>First step of the process that aims at describing the company domain in terms of owned
                            assets.
                            In other
                            terms this phase responds to the question "What do I own?”
                        </td>
                        <td class="text-center">
                            <i *ngIf="assetClusteringStatus === statusEnum.FULL" style="color: green"
                               class="fa fa-check"
                               aria-hidden="true"
                               [ngbTooltip]="statusEnum[assetClusteringStatus][0] + statusEnum[assetClusteringStatus].substr(1).toLowerCase()"></i>
                            <i *ngIf="assetClusteringStatus === statusEnum.EMPTY || assetClusteringStatus === statusEnum.PENDING"
                               style="color: orange" class="fa fa-exclamation-triangle" aria-hidden="true"
                               [ngbTooltip]="statusEnum[assetClusteringStatus][0] + statusEnum[assetClusteringStatus].substr(1).toLowerCase()"></i>
                        </td>
                        <td class="text-center">
                            <a *ngIf="assetClusteringStatus === statusEnum.EMPTY"
                               [routerLink]="['/identify-asset/asset-clustering']"><i class="fa fa-plus-square fa-lg"
                                                                                      placement="top"
                                                                                      ngbTooltip="Create"
                                                                                      aria-hidden="true"></i></a>
                            <ng-container
                                *ngIf="assetClusteringStatus === statusEnum.PENDING || assetClusteringStatus === statusEnum.FULL">
                                <a href="javascript:void(0)" (click)="open(alert,'/identify-asset/asset-clustering')"><i
                                    placement="top" ngbTooltip="Edit" class="fa fa-pencil-square-o fa-lg"
                                    aria-hidden="true"></i></a>
                            </ng-container>
                        </td>
                    </tr>
                    <tr>
                        <td>Impact Evaluation</td>
                        <td>Measuring the impact on assets</td>
                        <td class="text-center">
                            <i *ngIf="impactEvaluationStatus === statusEnum.FULL" style="color: green"
                               class="fa fa-check"
                               aria-hidden="true"
                               [ngbTooltip]="statusEnum[impactEvaluationStatus][0] + statusEnum[impactEvaluationStatus].substr(1).toLowerCase()"></i>
                            <i *ngIf="impactEvaluationStatus === statusEnum.EMPTY || impactEvaluationStatus === statusEnum.PENDING"
                               style="color: orange" class="fa fa-exclamation-triangle" aria-hidden="true"
                               [ngbTooltip]="statusEnum[impactEvaluationStatus][0] + statusEnum[impactEvaluationStatus].substr(1).toLowerCase()"></i>
                        </td>
                        <td class="text-center">
                            <a *ngIf="assetClusteringStatus === statusEnum.FULL && impactEvaluationStatus === statusEnum.EMPTY"
                               [routerLink]="['/impact-evaluation']">
                                <i class="fa fa-plus-square fa-lg" placement="top" ngbTooltip="Create"
                                   aria-hidden="true"></i>
                            </a>
                            <ng-container
                                *ngIf="impactEvaluationStatus === statusEnum.PENDING || impactEvaluationStatus === statusEnum.FULL">
                                <a href="javascript:void(0)" (click)="open(alert,'/impact-evaluation')"><i
                                    placement="top" ngbTooltip="Edit" class="fa fa-pencil-square-o fa-lg"
                                    aria-hidden="true"></i></a>
                            </ng-container>
                        </td>
                    </tr>
                    <tr *ngIf="selfAssessment.impactMode===impactModeEnum.QUANTITATIVE && impactEvaluationStatus === statusEnum.FULL">
                        <td>Estimation of the Attack Related Costs</td>
                        <td><p>Estimate the attack related costs; "Communicate or evaluate the costs of the declared
                            attack
                            costs"</p>
                            <p *ngIf="attackRelatedCostsStatus === statusEnum.EMPTY"><span
                                style="color: orange">WARNING!</span> No
                                <a href="javascript:void(0)" [routerLink]="['/identify-asset/attack-costs']">Attack
                                    Cost</a>
                                identified or no one
                                <a href="javascript:void(0)"
                                   [routerLink]="['/impact-evaluation/quantitative/attack-related-costs-estimation']">estimated</a>!
                            </p>
                            <p *ngIf="attackRelatedCostsStatus === statusEnum.PENDING"><span
                                style="color: orange">WARNING!</span> Some attack related costs have not been
                                <a href="javascript:void(0)"
                                   [routerLink]="['/impact-evaluation/quantitative/attack-related-costs-estimation']">valorized</a>.
                            </p>
                        </td>
                        <td class="text-center">
                            <i *ngIf="attackRelatedCostsStatus === statusEnum.FULL" style="color: green"
                               class="fa fa-check"
                               aria-hidden="true"
                               [ngbTooltip]="attackRelatedCostsStatus[0] + attackRelatedCostsStatus.substr(1).toLowerCase()"></i>
                            <i *ngIf="attackRelatedCostsStatus === statusEnum.EMPTY || attackRelatedCostsStatus === statusEnum.PENDING"
                               style="color: orange" class="fa fa-exclamation-triangle" aria-hidden="true"
                               [ngbTooltip]="attackRelatedCostsStatus[0] + attackRelatedCostsStatus.substr(1).toLowerCase()"></i>
                        </td>
                        <td class="text-center">
                            <a *ngIf="attackRelatedCostsStatus === statusEnum.EMPTY && impactEvaluationStatus === statusEnum.FULL"
                               [routerLink]="['/impact-evaluation/quantitative/attack-related-costs-estimation']"><i
                                class="fa fa-plus-square fa-lg"
                                placement="top" ngbTooltip="Create" aria-hidden="true"></i></a>
                            <ng-container
                                *ngIf="attackRelatedCostsStatus === statusEnum.PENDING || attackRelatedCostsStatus === statusEnum.FULL">
                                <a href="javascript:void(0)"
                                   (click)="open(alert,'/impact-evaluation/quantitative/attack-related-costs-estimation')"><i
                                    placement="top" ngbTooltip="Edit" class="fa fa-pencil-square-o fa-lg"
                                    aria-hidden="true"></i></a>
                            </ng-container>
                        </td>
                    </tr>
                    <tr>
                        <td>Risk Evaluation</td>
                        <td>Manage your risk based on cost benefit analisys. The general approach includes both
                            qualitative
                            and
                            quantitative metodologies based on risk definition (ISO31000) and risk management
                            (ISO31010).
                        </td>
                        <td class="text-center">
                            <i *ngIf="riskEvaluationStatus === statusEnum.FULL" style="color: green" class="fa fa-check"
                               aria-hidden="true"
                               [ngbTooltip]="riskEvaluationStatus[0] + riskEvaluationStatus.substr(1).toLowerCase()"></i>
                            <i *ngIf="riskEvaluationStatus === statusEnum.EMPTY || riskEvaluationStatus === statusEnum.PENDING"
                               style="color: orange" class="fa fa-exclamation-triangle" aria-hidden="true"
                               [ngbTooltip]="riskEvaluationStatus[0] + riskEvaluationStatus.substr(1).toLowerCase()"></i>
                        </td>
                        <td class="text-center">
                            <a *ngIf="riskEvaluationStatus === statusEnum.EMPTY && impactEvaluationStatus === statusEnum.FULL"
                               [routerLink]="['/risk-management/risk-evaluation']"><i class="fa fa-plus-square fa-lg"
                                                                                      placement="top"
                                                                                      ngbTooltip="Create"
                                                                                      aria-hidden="true"></i></a>
                            <ng-container
                                *ngIf="riskEvaluationStatus === statusEnum.PENDING || riskEvaluationStatus === statusEnum.FULL">
                                <a href="javascript:void(0)" (click)="open(alert,'/risk-management/risk-evaluation')"><i
                                    placement="top" ngbTooltip="Edit" class="fa fa-pencil-square-o fa-lg"
                                    aria-hidden="true"></i></a>
                            </ng-container>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <ng-template #alert let-d="dismiss" let-c="close">
                    <div class="modal-header">
                        <h4 class="modal-title" id="modal-basic-title">Edit notification</h4>
                        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <ng-container *ngIf="alertMessage">
                            {{alertMessage}}
                        </ng-container>
                        <ng-container *ngIf="!alertMessage">
                            <p>Editing such step may influence the entire assessment.</p>
                            <p>If you want to proceed, just click on "OK" and edit your preferences, otherwise, you can
                                just
                                proceed in "view" mode whitout make any changes.</p>
                            <p>Do you want to proceed?</p>
                        </ng-container>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline-dark" (click)="c('Save click')">OK</button>
                    </div>
                </ng-template>
            </div>
        </mat-expansion-panel>
    </mat-accordion>
</ng-container>
